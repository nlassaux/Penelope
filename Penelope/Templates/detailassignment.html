{% extends "base_log.html" %}
{% load url from future %}
{% block title %}Assignment | {{detailedassignment.name}}{% endblock %}

{% block breadcrumb %}

	<ul class="breadcrumb">
		<div class='swift'>
	    <li>>> <a href="/">Dashboard</a><span class="divider">/</span></li>
	    <li><a href="/{{detailedassignment.course.id}}/details/">{{detailedassignment.course}}</a><span class="divider">/</span></li>
	    <li class="active">{{detailedassignment.name}}</li>
	  </div>
  </ul>

{% endblock %}

{% block content %}

  <div class="page-header">
		<h1>{{detailedassignment.name}} <small>{{detailedassignment.description}}</small></h1>
    <div id='space'>
	    <strong>Last edit</strong> {{detailedassignment.editdate}}
	    <strong>Teachers</strong> 
    	{% for admin in detailedassignment.admins.all %}
    				{{admin.username}}
    	{% endfor %}
    </div>
  </div>
	

  <div class="row">
			{% if user == detailedassignment.course.owner %}
				<div class='span9'>
					{% if detailedassignment.group_set.all %}
						<table class="table table-striped">
							<thead>
								<tr>
									<th><h4>Groups :</h4></th>
									<th>Members</th>
								</tr>
							</thead>
							<tbody>
								{% for group in detailedassignment.group_set.all %}
									<tr>
					        	<td><a href="/groups/{{group.id}}/details/">{{group.name}}</a></td>
					        	<td>
					        		{% for user in group.members.all %}
					        			<div id='user-balise'>{{user.username}}</div>
					        		{% endfor %}
					        	</td>
									</tr>
								{% endfor %}
							</tbody>
						</table>
					{% else %}
						<a href="/groups/{{detailedassignment.id}}/add/">Create groups</a>
					{% endif %}
					</div>
					<div class='span2 admin-panel'>
						<ul class="nav nav-list">
					        <li class="nav-header">Administration</li>
					        <li><a href="#"><i class="icon-briefcase"></i> Change groups</a></li>
					        <li><a href="/assignments/{{detailedassignment.id}}/edit/"><i class="icon-pencil"></i> Edit</a></li>
					        <li><a href="#DeleteModal" data-toggle="modal"><i class="icon-remove-sign"></i> Delete</a></li>
					  </ul>
					</div>
	</div>

			{% else %}

				<div class = 'span5'>
					<dl class="dl-horizontal">
						<dt>Your group :</dt>
						{% if nogroup %}
						<dd>You have not got any group</dd>
						{% else %}
						<dd>Group {{ mygroup.name }}</dd>
						<dt>Members :</dt>
						{% for member in mygroup.members.all %}
					  <dd>{{ member }}</dd>
						{% endfor %}
					</dl>
				</div>
	</div>

				<h2>Files :</h2>

				<table class="table table-striped">
					<thead>
						<tr>
							<th>Name</th>
							<th>Size</th>
							<th>Upload date</th>
						</tr>
					</thead>
					{% for work in groupwork %}
						<tbody>
							<tr>
			        	<td>{{ work.file.name }}</td>
			        	<td>{{ work.file.size }} Octet</td>
			        	<td>{{ work.editdate }}</td>
							</tr>
						</tbody>
					{% endfor %}
				</table>

				<div class='span4 offset3'>
					<form action="" method="post" enctype="multipart/form-data">{% csrf_token %}
						{{form.file}}
					<input type="submit" value="Submit" class='btn btn-primary pull-right' />
				</div>
			{% endif %}

	{% endif %}

	{% if detailedassignment.deadline %}
		<div class='deadline'>Deadline : {{detailedassignment.deadline}}</div>
	{% endif %}

<div class="modal hide" id="DeleteModal">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal">Ã—</button>
    <h3>Delete the assignment</h3>
  </div>
  <div class="modal-body">
    <p>Are you sure you want to delete this assignment ? Groups, uploaded content will be deleted too..</p>
  </div>
  <div class="modal-footer">
    <a href="#" class="btn" data-dismiss="modal">Cancel</a>
    <a href="/assignments/{{detailedassignment.id}}/delete/" class="btn btn-danger">Delete</a>
  </div>
</div>

{% endblock %}
